<!DOCTYPE html>

<html>
<head>
  <title>Block specification</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="block-specification">Block specification</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> Block = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./index.js'</span>),
    $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./bower_components/jquery/dist/jquery.js'</span>);

describe(<span class="hljs-built_in">module</span>.id, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

    afterEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">''</span>;
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h3 id="initialization-process">Initialization process</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'initialization'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>You can pass option-object parameter to the constructor. All this options will be set directly on the block instance
as block properties and will be available throw this context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'Sets all initialization properties to block instance'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                number: <span class="hljs-number">1</span>,
                string: <span class="hljs-string">'string1'</span>,
                bool: <span class="hljs-literal">true</span>,
                array: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
            });

            expect(block.number).toEqual(<span class="hljs-number">1</span>);
            expect(block.string).toEqual(<span class="hljs-string">'string1'</span>);
            expect(block.bool).toEqual(<span class="hljs-literal">true</span>);
            expect(block.array).toEqual([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Block can be initialized as regular function without new keyword. It is useful when you need to wrap block
constructor into anonymous function for some initialization purposes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'Can be initialized without new keyword'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = Block({
                a: <span class="hljs-number">1</span>
            });

            expect(block.a).toBe(<span class="hljs-number">1</span>)
        });

        it(<span class="hljs-string">'Should call initialize method from constructor'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            spyOn(Block.prototype, <span class="hljs-string">'initialize'</span>);

            <span class="hljs-keyword">new</span> Block;

            expect(Block.prototype.initialize).toHaveBeenCalled();
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>By default initialize method is empty. So you can override it with your own logic.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'Can override initialize method'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> Block1 = Block.extend({
                count: <span class="hljs-number">0</span>,
                initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">this</span>.count++;
                }
            });

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block1({
                count: <span class="hljs-number">10</span>
            });

            expect(block.count).toEqual(<span class="hljs-number">11</span>)
        });

        it(<span class="hljs-string">'Should pass all initialization properties to initialize method'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> a, b, c;

            <span class="hljs-keyword">var</span> SomeBlock = Block.extend({
                initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options, param1, param2</span>)</span>{
                    a = options;
                    b = param1;
                    c = param2;
                }
            });

            <span class="hljs-keyword">new</span> SomeBlock({a: <span class="hljs-number">1</span>}, <span class="hljs-number">2</span>, <span class="hljs-string">'string'</span>);

            expect(a).toEqual({a: <span class="hljs-number">1</span>});
            expect(b).toEqual(<span class="hljs-number">2</span>);
            expect(c).toEqual(<span class="hljs-string">'string'</span>);
        });

        it(<span class="hljs-string">'Should pass all plain object properties by values and does not affect another instances'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> plainObject = {
                a: <span class="hljs-number">1</span>
            };

            <span class="hljs-keyword">var</span> block1 = <span class="hljs-keyword">new</span> Block({
                plainObject: plainObject
            });

            <span class="hljs-keyword">var</span> block2 = <span class="hljs-keyword">new</span> Block({
                plainObject: plainObject
            });

            block1.plainObject.a = <span class="hljs-number">2</span>;

            expect(block2.plainObject.a).toEqual(<span class="hljs-number">1</span>);
        });

        it(<span class="hljs-string">'Should trigger initializing event before initialization'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;div id="block"&gt;&lt;/div&gt;'</span>;

            <span class="hljs-keyword">var</span> a;

            <span class="hljs-keyword">var</span> SomeBlock = Block.extend({
                a: <span class="hljs-number">1</span>,
                initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
                    <span class="hljs-keyword">this</span>.a = <span class="hljs-number">2</span>;
                }
            });

            $(<span class="hljs-string">'#block'</span>).on(<span class="hljs-string">'initializing'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
                a = e.target.block.a;
            });

            <span class="hljs-keyword">new</span> SomeBlock({
                el: <span class="hljs-string">'#block'</span>
            });

            expect(a).toEqual(<span class="hljs-number">1</span>);
        });

        it(<span class="hljs-string">'Should trigger initialized event after initialization'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;div id="block"&gt;&lt;/div&gt;'</span>;

            <span class="hljs-keyword">var</span> a;

            <span class="hljs-keyword">var</span> SomeBlock = Block.extend({
                a: <span class="hljs-number">1</span>,
                initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
                    <span class="hljs-keyword">this</span>.a = <span class="hljs-number">2</span>;
                }
            });

            $(<span class="hljs-string">'#block'</span>).on(<span class="hljs-string">'initialized'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
                a = e.target.block.a;
            });

            <span class="hljs-keyword">new</span> SomeBlock({
                el: <span class="hljs-string">'#block'</span>
            });

            expect(a).toEqual(<span class="hljs-number">2</span>);

        });

        it(<span class="hljs-string">'Can return promise from initialize method'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">done</span>) </span>{

            <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;div id="block"&gt;&lt;/div&gt;'</span>;

            $(<span class="hljs-string">'#block'</span>).on(<span class="hljs-string">'initialized'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                done();
            });

            <span class="hljs-keyword">var</span> Block1 = Block.extend({
                el: <span class="hljs-string">'#block'</span>,
                initialize: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

                    <span class="hljs-keyword">var</span> deferred = $.Deferred();

                    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                        deferred.resolve();
                    }, <span class="hljs-number">100</span>);

                    <span class="hljs-keyword">return</span> deferred.promise();
                }
            });

            <span class="hljs-keyword">new</span> Block1;

        });

    });</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h3 id="extending-block-class">Extending Block class</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'extend method'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'instanceof should work as expected'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> Block1 = Block.extend(),
                Block2 = Block1.extend();

            <span class="hljs-keyword">var</span> block2 = <span class="hljs-keyword">new</span> Block2;

            expect(block2 <span class="hljs-keyword">instanceof</span> Block).toEqual(<span class="hljs-literal">true</span>);
            expect(block2 <span class="hljs-keyword">instanceof</span> Block1).toEqual(<span class="hljs-literal">true</span>);
            expect(block2 <span class="hljs-keyword">instanceof</span> Block2).toEqual(<span class="hljs-literal">true</span>);

        });

        it(<span class="hljs-string">'extend method should copy all properties to prototype'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> Block1 = Block.extend({
                number: <span class="hljs-number">1</span>,
                string: <span class="hljs-string">'string1'</span>,
                bool: <span class="hljs-literal">true</span>,
                array: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
            });

            <span class="hljs-keyword">var</span> Block2 = Block1.extend({
                number: <span class="hljs-number">2</span>
            }, {
                string: <span class="hljs-string">'string2'</span>
            }, {
                bool: <span class="hljs-literal">false</span>
            }, {
                array: [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]
            });

            <span class="hljs-keyword">var</span> block2 = <span class="hljs-keyword">new</span> Block2;

            expect(block2.number).toEqual(<span class="hljs-number">2</span>);
            expect(block2.string).toEqual(<span class="hljs-string">'string2'</span>);
            expect(block2.bool).toEqual(<span class="hljs-literal">false</span>);
            expect(block2.array).toEqual([<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]);
        });

        it(<span class="hljs-string">'extend method should merge all nested properties by deep merge algorithm'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> Block1 = Block.extend({
                nested: {
                    a: <span class="hljs-number">1</span>,
                    b: <span class="hljs-number">2</span>
                }
            });

            <span class="hljs-keyword">var</span> Block2 = Block1.extend({
                nested: {
                    a: <span class="hljs-number">2</span>,
                    c: <span class="hljs-number">3</span>
                }
            });

            <span class="hljs-keyword">var</span> block2 = <span class="hljs-keyword">new</span> Block2();

            expect(block2.nested).toEqual({
                a: <span class="hljs-number">2</span>,
                b: <span class="hljs-number">2</span>,
                c: <span class="hljs-number">3</span>
            });
        });

        it(<span class="hljs-string">'extend method should copy plain object properties by values and does not affect other instances'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> plainObject = {
                a: <span class="hljs-number">1</span>
            };

            <span class="hljs-keyword">var</span> Block1 = Block.extend({
                    plainObject: plainObject
                }),
                block1 = <span class="hljs-keyword">new</span> Block1;

            <span class="hljs-keyword">var</span> Block2 = Block.extend({
                    plainObject: plainObject
                }),
                block2 = <span class="hljs-keyword">new</span> Block2;

            block1.plainObject.a = <span class="hljs-number">2</span>;

            expect(block2.plainObject.a).toEqual(<span class="hljs-number">1</span>);
        });

        it(<span class="hljs-string">'Should copy not plain object properties by link'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> Block1 = Block.extend(),
                block1 = <span class="hljs-keyword">new</span> Block1;

            <span class="hljs-keyword">var</span> Block2 = Block.extend({
                    block1: block1
                }),
                block2 = <span class="hljs-keyword">new</span> Block2;

            expect(block2.block1).toEqual(block1);
        });

    });</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h3 id="block-el-element-property">Block el (element) property</h3>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'el property'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'el property should be empty div by default'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block;

            expect(block.el.tagName).toEqual(<span class="hljs-string">'DIV'</span>);
            expect(block.el.textContent).toEqual(<span class="hljs-string">''</span>);

        });

        it(<span class="hljs-string">'el property can be html string'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                el: <span class="hljs-string">'&lt;span&gt;text&lt;/span&gt;'</span>
            });

            expect(block.el.tagName).toEqual(<span class="hljs-string">'SPAN'</span>);
            expect(block.el.textContent).toEqual(<span class="hljs-string">'text'</span>);
        });

        it(<span class="hljs-string">'el property can be an existing html element'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                el: <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'b'</span>)
            });

            expect(block.el.tagName).toEqual(<span class="hljs-string">'B'</span>);
            expect(block.el.textContent).toEqual(<span class="hljs-string">''</span>);
        });

        it(<span class="hljs-string">'el property can be css selector'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;b id="block"&gt;test&lt;/b&gt;'</span>;

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                el: <span class="hljs-string">'#block'</span>
            });

            expect(block.el.tagName).toEqual(<span class="hljs-string">'B'</span>);
            expect(block.el.textContent).toEqual(<span class="hljs-string">'test'</span>);
        });

        it(<span class="hljs-string">'el property can be a function'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;b id="block"&gt;test&lt;/b&gt;'</span>;

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                elementID: <span class="hljs-string">'block'</span>,
                el: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-keyword">this</span>.elementID);
                }
            });

            expect(block.el.tagName).toEqual(<span class="hljs-string">'B'</span>);
            expect(block.el.textContent).toEqual(<span class="hljs-string">'test'</span>);
        });

        it(<span class="hljs-string">'el property has jQuery wrapper'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block;

            expect(block.$el[<span class="hljs-number">0</span>].tagName).toEqual(<span class="hljs-string">'DIV'</span>);
            expect(block.$el[<span class="hljs-number">0</span>].textContent).toEqual(<span class="hljs-string">''</span>);
        });

    });</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h3 id="get-method">get method</h3>
<p>You can get any block property by keypath (ex: <code>block.get(&#39;foo.bar.baz&#39;)</code>). If on of property in this path is function
(getter accessor) it will be executed with block context.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'get method'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'get method should return expected undefined property'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block();

            expect(block.get(<span class="hljs-string">'a.b'</span>)).toEqual(<span class="hljs-literal">undefined</span>);

        });

        it(<span class="hljs-string">'get method should return expected boolean property'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-literal">false</span>
                }
            });

            expect(block.get(<span class="hljs-string">'a.b'</span>)).toEqual(<span class="hljs-literal">false</span>);

        });

        it(<span class="hljs-string">'get method should return expected number property'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-number">1</span>
                }
            });

            expect(block.get(<span class="hljs-string">'a.b'</span>)).toEqual(<span class="hljs-number">1</span>);

        });

        it(<span class="hljs-string">'get method should return expected string property'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-string">'b'</span>
                }
            });

            expect(block.get(<span class="hljs-string">'a.b'</span>)).toEqual(<span class="hljs-string">'b'</span>);

        });

        it(<span class="hljs-string">'get method should return function result with block context'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.c;
                    }
                },
                c: <span class="hljs-string">'result'</span>
            });

            expect(block.get(<span class="hljs-string">'a.b'</span>)).toEqual(<span class="hljs-string">'result'</span>);

        });

    });</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h3 id="set-method">set method</h3>
<p><code>set</code> method update or create property by keypath. If some property in this path does not exist it will be created automatically.
<code>set</code> method return only changed properties.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'set method'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'set method should add new property to the instance and create new objects if necessary'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block;

            block.set(<span class="hljs-string">'a.b.c'</span>, <span class="hljs-string">'abc'</span>);

            expect(block.a.b.c).toBe(<span class="hljs-string">'abc'</span>);
        });

        it(<span class="hljs-string">'set method should return only changed properties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-string">'b'</span>,
                    c: <span class="hljs-string">'c'</span>,
                    d: <span class="hljs-string">'d'</span>
                }
            });

            <span class="hljs-keyword">var</span> changedProps = block.set(<span class="hljs-string">'a'</span>, {
                e: <span class="hljs-string">'e'</span>,
                b: <span class="hljs-string">'b'</span>,
                c: <span class="hljs-string">'cc'</span>
            });

            expect(changedProps).toEqual({a: {e: <span class="hljs-string">'e'</span>, c: <span class="hljs-string">'cc'</span>}});
        });

        it(<span class="hljs-string">'set method should modify array without merging'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                array: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
            });

            block.set(<span class="hljs-string">'array'</span>, [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]);

            expect(block.array).toEqual([<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]);

        });

        it(<span class="hljs-string">'set method should modify object value by key path'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-string">'b'</span>
                }
            });

            block.set(<span class="hljs-string">'a.b'</span>, <span class="hljs-string">'c'</span>);

            expect(block.a.b).toEqual(<span class="hljs-string">'c'</span>);
        });

        it(<span class="hljs-string">'set method should set boolean value event it is false'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-string">'b'</span>
                }
            });

            block.set(<span class="hljs-string">'a.b'</span>, <span class="hljs-literal">false</span>);

            expect(block.a.b).toEqual(<span class="hljs-literal">false</span>);
        });

        it(<span class="hljs-string">'set method should set number event it is 0'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-string">'b'</span>
                }
            });

            block.set(<span class="hljs-string">'a.b'</span>, <span class="hljs-number">0</span>);

            expect(block.a.b).toEqual(<span class="hljs-number">0</span>);
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p><code>set</code> method will trigger corresponding <code>change</code> events if any properties in keypath are changed.
For nested properties all chain will be triggered from lowest level. (ex: <code>change:foo.bar.baz</code> -&gt; <code>change:foo.bar</code> -&gt; <code>change:foo</code>)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        it(<span class="hljs-string">'set should trigger change events'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> change1 = jasmine.createSpy(<span class="hljs-string">'a.b'</span>),
                change2 = jasmine.createSpy(<span class="hljs-string">'a.c'</span>),
                change3 = jasmine.createSpy(<span class="hljs-string">'a'</span>);

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                a: {
                    b: <span class="hljs-string">'b'</span>,
                    c: <span class="hljs-string">'c'</span>
                }
            });

            block.on(<span class="hljs-string">'change:a.b'</span>, change1);
            block.on(<span class="hljs-string">'change:a.c'</span>, change2);
            block.on(<span class="hljs-string">'change:a'</span>, change3);

            block.set(<span class="hljs-string">'a'</span>, {
                b: <span class="hljs-string">'new'</span>,
                c: <span class="hljs-string">'c'</span>
            });

            expect(change1).toHaveBeenCalled();
            expect(change2).not.toHaveBeenCalled();

        });

    });</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h3 id="include-method">include method</h3>
<p><code>include</code> method is proper way to decompose block on sub-blocks. It will automatically initialize and remove all nested
blocks to avoid memory leaks.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'include method'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'include method can include block constructor and pass properties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> child = Block.extend({
                template: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div class="child"&gt;'</span> + <span class="hljs-keyword">this</span>.text + <span class="hljs-string">'&lt;/div&gt;'</span>
                }
            });

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                template: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div&gt;'</span> + <span class="hljs-keyword">this</span>.include(child, {text: <span class="hljs-string">'child'</span>}) + <span class="hljs-string">'&lt;/div&gt;'</span>
                }
            });

            expect(block.el.querySelector(<span class="hljs-string">'.child'</span>).innerHTML).toEqual(<span class="hljs-string">'child'</span>);
        });

        it(<span class="hljs-string">'include method can include block instance'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> child = Block.extend({
                template: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div class="child"&gt;'</span> + <span class="hljs-keyword">this</span>.text + <span class="hljs-string">'&lt;/div&gt;'</span>
                }
            });

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                template: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div&gt;'</span> + <span class="hljs-keyword">this</span>.include(child({text: <span class="hljs-string">'child'</span>})) + <span class="hljs-string">'&lt;/div&gt;'</span>
                }
            });

            expect(block.el.querySelector(<span class="hljs-string">'.child'</span>).innerHTML).toEqual(<span class="hljs-string">'child'</span>);
        });

        it(<span class="hljs-string">'include method can include partial function'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> partial = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div class="child"&gt;'</span> + <span class="hljs-keyword">this</span>.text + <span class="hljs-string">'&lt;/div&gt;'</span>
            };

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                text: <span class="hljs-string">'child'</span>,
                template: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div&gt;'</span> + <span class="hljs-keyword">this</span>.include(partial) + <span class="hljs-string">'&lt;/div&gt;'</span>
                }
            });

            expect(block.el.querySelector(<span class="hljs-string">'.child'</span>).innerHTML).toEqual(<span class="hljs-string">'child'</span>);
        });

        it(<span class="hljs-string">'include method can include html string'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> htmlString = <span class="hljs-string">'&lt;div class="child"&gt;child&lt;/div&gt;'</span>;

            <span class="hljs-keyword">var</span> block = <span class="hljs-keyword">new</span> Block({
                template: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;div&gt;'</span> + <span class="hljs-keyword">this</span>.include(htmlString) + <span class="hljs-string">'&lt;/div&gt;'</span>
                }
            });

            expect(block.el.querySelector(<span class="hljs-string">'.child'</span>).innerHTML).toEqual(<span class="hljs-string">'child'</span>);
        });

    });</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h3 id="global-events">Global Events</h3>
<p>Independent blocks (blocks that are not parent and child to each other) can subscribe to each other by <code>globalEvents</code>
property. It will properly remove all global events when one of the block is removed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    describe(<span class="hljs-string">'Global events'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'Can subscribe to independent block events'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

            <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;div id="block1"&gt;&lt;/div&gt;&lt;div id="block2"&gt;&lt;/div&gt;'</span>;

            <span class="hljs-keyword">var</span> eventHandler = jasmine.createSpy(<span class="hljs-string">'eventHandler'</span>);

            <span class="hljs-keyword">var</span> a, b;

            <span class="hljs-keyword">var</span> Block1 = Block.extend({
                el: <span class="hljs-string">'#block1'</span>,
                globalEvents: {
                    <span class="hljs-string">'event #block2'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e, param1, param2</span>) </span>{

                        eventHandler();
                        a = param1;
                        b = param2;
                    }
                }
            });

            <span class="hljs-keyword">var</span> Block2 = Block.extend({
                el: <span class="hljs-string">'#block2'</span>
            });

            <span class="hljs-keyword">var</span> block1 = <span class="hljs-keyword">new</span> Block1;
            <span class="hljs-keyword">var</span> block2 = <span class="hljs-keyword">new</span> Block2;

            block2.trigger(<span class="hljs-string">'event'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>);

            expect(eventHandler).toHaveBeenCalled();
            expect(a).toEqual(<span class="hljs-string">'a'</span>);
            expect(b).toEqual(<span class="hljs-string">'b'</span>);

        });

    });

});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
